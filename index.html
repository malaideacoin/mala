<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MalaIdeaCoin (MALA) - ¡Celebra las peores ideas!</title>

  <!-- Favicon: Verifica que "images/favicon.ico" exista -->
  <link rel="icon" href="images/favicon.ico" />

  <!-- Meta tags para SEO y Open Graph -->
  <meta name="description" content="MalaIdeaCoin (MALA) celebra las peores ideas, transformándolas en el motor de una comunidad creativa y divertida. Únete a la revolución de las malas ideas!" />
  <meta name="keywords" content="MalaIdeaCoin, MALA, meme coin, cripto, blockchain, humor, creatividad" />
  <meta name="author" content="Tu Nombre o Empresa" />
  <meta property="og:title" content="MalaIdeaCoin (MALA) - ¡Celebra las peores ideas!" />
  <meta property="og:description" content="MalaIdeaCoin celebra las peores ideas y fomenta una comunidad creativa y divertida. ¡Únete a la revolución de las malas ideas!" />
  <meta property="og:image" content="images/malaideacoin.png" />
  <meta property="og:url" content="https://tu-dominio.com" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Montserrat:wght@400;700&family=Poppins:wght@400;600&display=swap"
    rel="stylesheet"
  />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <!-- Solana Web3.js (cargado con defer) -->
  <script defer src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>

  <!-- Estilos en línea -->
  <style>
    /* ================= PRELOADER ================= */
    #preloader {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: #000; z-index: 9999;
      display: flex; align-items: center; justify-content: center;
    }
    .spinner {
      border: 8px solid #333;
      border-top: 8px solid #e63946;
      border-radius: 50%;
      width: 60px; height: 60px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* ================= VARIABLES DE TEMA ================= */
    :root {
      --accent-color: #e63946;
      --accent-hover: #b32d39;
      --card-bg: rgba(26, 26, 26, 0.85);
      --navbar-bg: rgba(0, 0, 0, 0.85);
      --text-color: #ccc;
      --glass-blur: 8px;
    }
    body.light-mode {
      --accent-color: #0077cc;
      --accent-hover: #005fa3;
      --card-bg: rgba(245, 245, 245, 0.95);
      --navbar-bg: rgba(255, 255, 255, 0.95);
      --text-color: #333;
    }

    /* ================= ESTILOS BASE ================= */
    * { box-sizing: border-box; }
    body, html {
      margin: 0; padding: 0;
      font-family: 'Montserrat', sans-serif;
      color: var(--text-color);
      overflow-x: hidden;
      line-height: 1.6;
    }
    body {
      /* Ajusta la ruta si es necesario */
      background: #111 url("images/malaideacoin.png") no-repeat center center fixed;
      background-size: cover;
    }
    body::before {
      content: "";
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: -1;
    }

    /* ================= ANIMACIONES ================= */
    @keyframes fadeSlideIn {
      0% { opacity: 0; transform: translateY(-20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInUp {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    /* ================= NAVBAR ================= */
    nav {
      background: var(--navbar-bg);
      position: sticky; top: 0; z-index: 100;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.7);
    }
    nav .nav-container {
      display: flex; justify-content: space-between; align-items: center;
      padding: 10px 20px;
    }
    nav .logo {
      font-size: 1.5em; font-weight: bold; color: var(--accent-color);
    }
    nav ul {
      list-style: none; display: flex; gap: 20px; align-items: center;
    }
    nav ul li a {
      text-decoration: none; color: var(--text-color); font-weight: bold;
      transition: color 0.3s, transform 0.3s;
    }
    nav ul li a:hover { color: var(--accent-color); transform: scale(1.05); }
    nav button, nav select {
      background: var(--accent-color); border: none; color: #fff;
      padding: 8px 12px; border-radius: 5px; cursor: pointer;
      transition: background 0.3s;
    }
    nav button:hover { background: var(--accent-hover); }
    nav select {
      background: var(--card-bg); color: var(--text-color);
      font-weight: bold; cursor: pointer;
    }

    /* ================= HEADER (HERO) ================= */
    header {
      position: relative; height: 500px; text-align: center; color: #fff;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      padding: 0 20px; transition: transform 0.2s ease-out;
    }
    header::after {
      content: ""; position: absolute; top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6); z-index: -1;
    }
    header h1 {
      font-family: 'Luckiest Guy', cursive; font-size: 4rem;
      margin: 0; text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
      animation: fadeSlideIn 2s ease-out;
    }
    header p {
      font-size: 1.5rem; margin-top: 20px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
      animation: fadeSlideIn 2s ease-out 0.5s forwards;
    }
    .cta-buttons {
      margin-top: 30px; display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;
    }
    .cta-buttons a {
      background: var(--accent-color); color: #fff;
      padding: 15px 30px; border-radius: 50px; text-decoration: none; font-weight: bold;
      transition: background 0.3s, transform 0.3s;
    }
    .cta-buttons a:hover { background: var(--accent-hover); transform: scale(1.05); }

    /* ================= CONTADOR (COUNTDOWN) ================= */
    #countdownSection {
      background: rgba(0,0,0,0.7);
      padding: 20px; margin: 20px auto; max-width: 800px; text-align: center;
      border: 2px solid var(--accent-color); border-radius: 10px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.8);
      font-family: 'Montserrat', sans-serif; color: #fff;
    }
    #countdownSection h2 {
      margin: 0; font-size: 2rem; animation: fadeInUp 1s ease-out;
    }
    #countdownTimer {
      font-size: 1.5em; margin-top: 10px; animation: fadeInUp 1s ease-out;
    }

    /* ================= SECCIONES VARIAS ================= */
    .dashboard,
    .market-info,
    .roadmap,
    .tokenomics,
    .idea-of-day,
    .form-container {
      background: var(--card-bg); backdrop-filter: blur(var(--glass-blur));
      box-shadow: 0 2px 16px rgba(0,0,0,0.8);
      border-radius: 10px; padding: 20px; margin: 20px auto; max-width: 800px;
      text-align: center; animation: fadeInUp 1s ease-out;
    }
    .dashboard h2, .market-info h2, .roadmap h2,
    .tokenomics h2, .idea-of-day h2, .form-container h2 {
      margin-bottom: 10px; color: var(--accent-color);
      font-family: 'Luckiest Guy', cursive;
    }

    .story-section {
      background: linear-gradient(135deg, rgba(255,65,108,0.4), rgba(35,214,171,0.4));
      border: 2px solid var(--accent-color); border-radius: 10px; padding: 20px;
      margin: 20px auto; max-width: 800px; text-align: center;
      font-family: 'Poppins', sans-serif; color: #fff; text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .story-section:hover { transform: scale(1.02); box-shadow: 0 4px 20px rgba(0,0,0,0.5); }
    .story-section h2 {
      font-family: 'Luckiest Guy', cursive; color: var(--accent-color); margin-bottom: 10px;
    }

    #team {
      background: var(--card-bg); backdrop-filter: blur(var(--glass-blur));
      padding: 30px; margin: 20px auto; max-width: 800px; border-radius: 10px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.8); text-align: center; animation: fadeInUp 1s ease-out;
    }
    #team h2 {
      font-family: 'Luckiest Guy', cursive; color: var(--accent-color); margin-bottom: 20px;
    }
    .team-members {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;
    }
    .team-card {
      background: rgba(0,0,0,0.6); padding: 20px; border-radius: 10px; color: #fff;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .team-card:hover { transform: translateY(-5px); box-shadow: 0 4px 20px rgba(0,0,0,0.9); }
    .team-avatar {
      width: 80px; height: 80px; margin: 0 auto 10px; border-radius: 50%;
      background: var(--accent-color); display: flex; align-items: center; justify-content: center;
      font-size: 1.5rem; font-weight: bold; color: #fff;
    }

    .controls {
      max-width: 800px; margin: 20px auto;
      display: flex; justify-content: space-between; flex-wrap: wrap; gap: 10px;
    }
    .controls input[type="text"], .controls select {
      padding: 10px; border: 1px solid #444; border-radius: 5px;
      background: var(--card-bg); color: var(--text-color);
    }
    .controls input[type="text"] { width: 60%; }

    .ideas-section { margin-top: 40px; }
    .ideas-section h2 {
      text-align: center; margin-bottom: 30px; color: var(--accent-color);
      font-family: 'Luckiest Guy', cursive; animation: fadeInUp 1s ease-out;
    }
    .idea-card {
      background: var(--card-bg); backdrop-filter: blur(var(--glass-blur));
      padding: 20px; margin: 15px auto; max-width: 800px; border-radius: 10px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.8); transition: transform 0.3s, box-shadow 0.3s;
      position: relative; animation: fadeInUp 0.8s ease-out;
    }
    .idea-card:hover { transform: translateY(-5px) rotateX(2deg); box-shadow: 0 4px 20px rgba(0,0,0,0.9); }
    .idea-card p { margin: 10px 0; }
    .vote-button, .share-button, .comment-button {
      background: var(--accent-color); border: none; color: white;
      padding: 8px 12px; border-radius: 5px; cursor: pointer;
      transition: background 0.3s; margin-right: 5px;
    }
    .vote-button:hover, .share-button:hover, .comment-button:hover { background: var(--accent-hover); }

    .comments-section {
      margin-top: 10px; border-top: 1px solid #444; padding-top: 10px;
      display: none;
    }
    .comments-section ul { list-style: none; padding-left: 0; }
    .comments-section li {
      margin-bottom: 5px; font-size: 0.9em; color: #aaa;
      display: flex; justify-content: space-between; align-items: center;
    }
    .comments-section li span { flex-grow: 1; }
    .comments-section li button.delete-comment {
      background: transparent; border: none; color: var(--accent-color);
      cursor: pointer; font-size: 0.9em;
    }
    .comments-section input[type="text"] {
      padding: 8px; border: 1px solid #444; border-radius: 5px;
      width: calc(100% - 100px); margin-right: 5px;
      background: var(--card-bg); color: var(--text-color);
    }
    .comments-section button.send-comment {
      padding: 8px 12px; border: none; border-radius: 5px;
      background: var(--accent-color); color: white; cursor: pointer;
      transition: background 0.3s;
    }
    .comments-section button.send-comment:hover { background: var(--accent-hover); }

    .form-container {
      background: var(--card-bg); backdrop-filter: blur(var(--glass-blur));
      padding: 30px; margin: 40px auto; max-width: 800px; border-radius: 10px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.8); animation: fadeInUp 1s ease-out;
    }
    .form-container h2 {
      text-align: center; margin-bottom: 20px; color: var(--accent-color);
      font-family: 'Luckiest Guy', cursive;
    }
    .form-container form {
      display: flex; flex-direction: column; gap: 15px;
    }
    .form-container input[type="text"], .form-container textarea {
      padding: 15px; border: 1px solid #444; border-radius: 5px;
      font-size: 1em; width: 100%; background: var(--card-bg); color: var(--text-color);
    }
    .form-container input[type="submit"] {
      background: var(--accent-color); color: #fff; padding: 15px;
      border: none; border-radius: 5px; cursor: pointer; font-weight: bold;
      font-size: 1.1em; transition: background 0.3s;
    }
    .form-container input[type="submit"]:hover { background: var(--accent-hover); }

    /* ================= FOOTER ================= */
    footer {
      background: #000; color: #777; text-align: center; padding: 20px;
      font-size: 0.9em;
    }
    footer .social-links { margin-top: 10px; }
    footer .social-links a {
      color: var(--text-color); font-size: 1.5rem; margin: 0 10px;
      transition: color 0.3s;
    }
    footer .social-links a:hover { color: var(--accent-color); }
    footer .newsletter { margin-top: 20px; }
    footer .newsletter form {
      display: flex; justify-content: center; gap: 10px;
    }
    footer .newsletter input[type="email"] {
      padding: 10px; border: 1px solid #444; border-radius: 5px;
    }
    footer .newsletter button {
      background: var(--accent-color); color: #fff; border: none;
      padding: 10px 20px; border-radius: 5px; cursor: pointer;
      transition: background 0.3s;
    }
    footer .newsletter button:hover { background: var(--accent-hover); }

    /* Botón Volver al Inicio */
    #backToTop {
      position: fixed; bottom: 30px; left: 30px;
      background: var(--accent-color); color: white;
      padding: 10px 15px; border: none; border-radius: 50%;
      cursor: pointer; opacity: 0; transition: opacity 0.3s; z-index: 200;
    }

    /* Toast Notificaciones */
    #toast {
      position: fixed; bottom: 30px; right: 30px;
      background: var(--accent-color); color: white;
      padding: 15px 20px; border-radius: 5px;
      opacity: 0; transition: opacity 0.5s; z-index: 200;
    }

    /* ================= RESPONSIVIDAD ================= */
    @media (max-width: 768px) {
      header h1 { font-size: 2.8rem; }
      header p { font-size: 1.1rem; }
      nav .nav-container { flex-direction: column; }
      nav ul { flex-direction: column; gap: 10px; }
      .controls input[type="text"] { width: 100%; }
    }
  </style>
</head>
<body>
  <!-- PRELOADER -->
  <div id="preloader">
    <div class="spinner"></div>
  </div>

  <!-- NAVBAR -->
  <nav>
    <div class="nav-container">
      <div class="logo">MalaIdeaCoin</div>
      <ul>
        <li><a href="#home">Inicio</a></li>
        <li><a href="#proponer">Proponer</a></li>
        <li><a href="#votar">Votar</a></li>
        <li>
          <select id="langSelect">
            <option value="es">Español</option>
            <option value="en">English</option>
          </select>
        </li>
        <li><button class="theme-toggle" id="themeToggle">Toggle Theme</button></li>
        <li><button class="wallet-toggle" id="connectWallet">Conectar Wallet</button></li>
      </ul>
    </div>
  </nav>

  <!-- HEADER (HERO) -->
  <header id="home">
    <h1 id="headerH1">MalaIdeaCoin (MALA)</h1>
    <p id="headerP">¡Celebra las peores ideas y gana tokens!</p>
    <div class="cta-buttons">
      <a href="#proponer">Proponer Idea</a>
      <a href="#votar">Votar Ideas</a>
    </div>
  </header>

  <!-- CONTADOR -->
  <section id="countdownSection">
    <h2 id="countdownTitle">Cuenta Regresiva para el Lanzamiento</h2>
    <div id="countdownTimer">Cargando...</div>
  </section>

  <!-- SECCIÓN HISTORIA -->
  <section class="story-section" id="story">
    <h2 id="storyTitle">¿Qué es MalaIdeaCoin?</h2>
    <p id="storyContent">
      MalaIdeaCoin (MALA) celebra las peores ideas, transformándolas en el motor de una comunidad creativa y divertida. Inspirado en el humor y la ironía, este token demuestra que hasta las ideas más “malas” pueden convertirse en una fuente de inspiración y entretenimiento. ¡Únete a la revolución de las malas ideas y sé parte de esta experiencia única!
    </p>
  </section>

  <!-- SECCIÓN EQUIPO -->
  <section id="team">
    <h2 id="teamTitle">Nuestro Equipo</h2>
    <div class="team-members">
      <div class="team-card">
        <div class="team-avatar">JP</div>
        <h3>Juan Pérez</h3>
        <p>CEO & Fundador</p>
      </div>
      <div class="team-card">
        <div class="team-avatar">MG</div>
        <h3>María García</h3>
        <p>CTO</p>
      </div>
      <div class="team-card">
        <div class="team-avatar">LM</div>
        <h3>Luis Martínez</h3>
        <p>Marketing</p>
      </div>
    </div>
  </section>

  <!-- INFORMACIÓN DE MERCADO -->
  <section class="market-info" id="marketInfo">
    <h2 id="marketInfoTitle">Información de Mercado</h2>
    <p id="priceInfo">--</p>
  </section>

  <!-- DASHBOARD -->
  <section class="dashboard" id="dashboard">
    <h2 id="dashboardTitle">Dashboard</h2>
    <p id="walletNotConnected">Wallet: No conectada</p>
    <p id="walletBalance">Balance: $0 SOL</p>
  </section>

  <!-- IDEA DEL DÍA -->
  <section class="idea-of-day" id="ideaDelDia">
    <h2 id="ideaOfDayTitle">Idea del Día</h2>
    <p id="ideaDiaTexto"><strong>Idea:</strong> Cargando...</p>
    <p id="ideaDiaVotos"><strong>Votos:</strong> 0</p>
  </section>

  <!-- ROADMAP -->
  <section class="roadmap" id="roadmap">
    <h2 id="roadmapTitle">Roadmap</h2>
    <ul>
      <li id="roadmapPhase1">Fase 1: Lanzamiento oficial de la web y del token MALA.</li>
      <li id="roadmapPhase2">Fase 2: Implementación de votaciones on-chain y conexión con pum.fun.</li>
      <li id="roadmapPhase3">Fase 3: Integración de funciones avanzadas como comentarios y recompensas.</li>
      <li id="roadmapPhase4">Fase 4: Expansión de la comunidad y establecimiento de alianzas estratégicas.</li>
      <li id="roadmapPhase5">Fase 5: Implementación de nuevas funcionalidades (staking, DAO, etc.) y mejoras globales.</li>
    </ul>
  </section>

  <!-- TOKENOMICS -->
  <section class="tokenomics" id="tokenomics">
    <h2 id="tokenomicsTitle">Tokenomics</h2>
    <p id="supplyTotal"><strong>Supply Total:</strong> 1,000,000,000 MALA</p>
    <ul>
      <li id="tokenomicsItem1">La mayor parte del suministro se distribuirá directamente a la comunidad para incentivar la participación activa y recompensar la contribución.</li>
      <li id="tokenomicsItem2">Todos los tokens se lanzarán exclusivamente en pum.fun, sin realizar ventas privadas.</li>
      <li id="tokenomicsItem3">Se asignarán tokens para impulsar campañas de marketing y el crecimiento del ecosistema.</li>
      <li id="tokenomicsItem4">También se reservarán tokens para garantizar liquidez y estabilidad en el mercado.</li>
      <li id="tokenomicsItem5">Una cantidad limitada se destinará al equipo y asesores para impulsar el desarrollo continuo.</li>
    </ul>
  </section>

  <!-- CONTROLES DE BÚSQUEDA -->
  <div class="controls">
    <input type="text" id="searchInput" placeholder="Buscar ideas..." />
    <select id="sortSelect">
      <option value="desc">Más votadas</option>
      <option value="asc">Menos votadas</option>
    </select>
  </div>

  <!-- IDEAS PROPUESTAS -->
  <section class="ideas-section" id="votar">
    <h2 id="proposedIdeasTitle">Ideas Propuestas</h2>
    <div id="ideasContainer"><!-- Se renderizan las ideas dinámicamente --></div>
  </section>

  <!-- FORMULARIO PARA PROPONER IDEAS -->
  <section class="form-container" id="proponer">
    <h2 id="proposeIdeaTitle">Proponer una Mala Idea</h2>
    <form id="ideaForm">
      <input type="text" id="ideaTitle" placeholder="Título de la idea" required />
      <textarea id="ideaDescription" placeholder="Descripción de la idea" rows="4" required></textarea>
      <input type="submit" id="submitIdea" value="Enviar Idea" />
    </form>
  </section>

  <!-- BOTÓN VOLVER AL INICIO -->
  <button id="backToTop">↑</button>

  <!-- TOAST NOTIFICACIONES -->
  <div id="toast"></div>

  <!-- FOOTER -->
  <footer>
    <p id="footerRights">&copy; 2025 MalaIdeaCoin. Todos los derechos reservados.</p>
    <div class="social-links">
      <a href="mailto:malaideacoin@gmail.com" target="_blank" aria-label="Email"><i class="fa-solid fa-envelope"></i></a>
      <a href="https://t.me/+ET-lS3L3IlM0Yzgx" target="_blank" aria-label="Telegram"><i class="fab fa-telegram"></i></a>
      <a href="https://x.com/malaideaco75556" target="_blank" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
      <a href="https://discord.gg/Qzp8m49n" target="_blank" aria-label="Discord"><i class="fab fa-discord"></i></a>
    </div>
    <div class="newsletter">
      <p id="subscribeNewsletter">Suscríbete a nuestro newsletter:</p>
      <form id="newsletterForm">
        <input type="email" placeholder="Tu correo electrónico" required />
        <button type="submit" id="newsletterSubmit">Suscribirse</button>
      </form>
    </div>
  </footer>

  <!-- =========== SCRIPT PRINCIPAL (CON ORDEN CORRECTO) =========== -->
  <script>
    /**************************************************
     * VARIABLES GLOBALES
     **************************************************/
    // Aseguramos declarar las variables globales antes de usarlas
    let currentLanguage = "es";
    // Variables de ideas y comentarios (se usan en renderIdeas)
    let sampleIdeas = [
      { id: 1, title: "Un ascensor que cuente chistes malos en cada piso.", votes: 42 },
      { id: 2, title: "Una app que te recuerde cuánto procrastinas.", votes: 37 },
      { id: 3, title: "Una máquina expendedora de malas ideas que nunca funcione correctamente.", votes: 75 },
      { id: 4, title: "Una alarma que suene con el sonido de un bostezo eterno.", votes: 15 }
    ];
    let comments = {};

    // Objeto de traducciones (ES e EN)
    const translations = {
      es: {
        title: "MalaIdeaCoin (MALA) - ¡Celebra las peores ideas!",
        headerH1: "MalaIdeaCoin (MALA)",
        headerP: "¡Celebra las peores ideas y gana tokens!",
        countdownTitle: "Cuenta Regresiva para el Lanzamiento",
        countdownLoading: "Cargando...",
        storyTitle: "¿Qué es MalaIdeaCoin?",
        storyContent: "MalaIdeaCoin (MALA) celebra las peores ideas, transformándolas en el motor de una comunidad creativa y divertida. Inspirado en el humor y la ironía, este token demuestra que hasta las ideas más “malas” pueden convertirse en una fuente de inspiración y entretenimiento. ¡Únete a la revolución de las malas ideas y sé parte de esta experiencia única!",
        marketInfoTitle: "Información de Mercado",
        dashboardTitle: "Dashboard",
        walletNotConnected: "Wallet: No conectada",
        ideaOfDayTitle: "Idea del Día",
        roadmapTitle: "Roadmap",
        roadmapPhase1: "Fase 1: Lanzamiento oficial de la web y del token MALA.",
        roadmapPhase2: "Fase 2: Implementación de votaciones on-chain y conexión con pum.fun.",
        roadmapPhase3: "Fase 3: Integración de funciones avanzadas como comentarios y recompensas.",
        roadmapPhase4: "Fase 4: Expansión de la comunidad y establecimiento de alianzas estratégicas.",
        roadmapPhase5: "Fase 5: Implementación de nuevas funcionalidades (staking, DAO, etc.) y mejoras globales.",
        tokenomicsTitle: "Tokenomics",
        supplyTotal: "Supply Total: 1,000,000,000 MALA",
        tokenomicsItem1: "La mayor parte del suministro se distribuirá directamente a la comunidad para incentivar la participación activa y recompensar la contribución.",
        tokenomicsItem2: "Todos los tokens se lanzarán exclusivamente en pum.fun, sin realizar ventas privadas.",
        tokenomicsItem3: "Se asignarán tokens para impulsar campañas de marketing y el crecimiento del ecosistema.",
        tokenomicsItem4: "También se reservarán tokens para garantizar liquidez y estabilidad en el mercado.",
        tokenomicsItem5: "Una cantidad limitada se destinará al equipo y asesores para impulsar el desarrollo continuo.",
        searchPlaceholder: "Buscar ideas...",
        proposedIdeasTitle: "Ideas Propuestas",
        proposeIdeaTitle: "Proponer una Mala Idea",
        ideaTitlePlaceholder: "Título de la idea",
        ideaDescriptionPlaceholder: "Descripción de la idea",
        submitIdea: "Enviar Idea",
        teamTitle: "Nuestro Equipo",
        footerRights: "© 2025 MalaIdeaCoin. Todos los derechos reservados.",
        subscribeNewsletter: "Suscríbete a nuestro newsletter:",
        subscribe: "Suscribirse",
        walletConnect: "Conectar Wallet",
        toggleTheme: "Toggle Theme",
        ideaLabel: "Idea:",
        votesLabel: "Votos:",
        voteButton: "Votar",
        shareButton: "Compartir",
        commentButton: "Comentarios",
        addCommentPlaceholder: "Agrega un comentario",
        commentSend: "Enviar",
        noComments: "No hay comentarios aún.",
        commentDelete: "Eliminar",
        priceLabel: "Precio de SOL:",
        walletBalanceError: "Error al obtener el balance de Solana",
        walletConnectError: "Error al conectar la wallet",
        walletConnected: "Wallet conectada:",
        phantomInstall: "Por favor, instala Phantom Wallet.",
        ideaCopied: "Idea copiada al portapapeles",
        copyError: "Error al copiar",
        fillAllFields: "Por favor, completa todos los campos",
        ideaSubmitted: "Idea enviada exitosamente",
        commentEmpty: "Ingrese un comentario",
        commentAdded: "Comentario agregado",
        commentDeleted: "Comentario eliminado"
      },
      en: {
        title: "MalaIdeaCoin (MALA) - Celebrate the Worst Ideas!",
        headerH1: "MalaIdeaCoin (MALA)",
        headerP: "Celebrate the worst ideas and earn tokens!",
        countdownTitle: "Countdown to Launch",
        countdownLoading: "Loading...",
        storyTitle: "What is MalaIdeaCoin?",
        storyContent: "MalaIdeaCoin (MALA) celebrates the worst ideas, transforming them into the engine of a creative and fun community. Inspired by humor and irony, this token shows that even the worst ideas can become a source of inspiration and entertainment. Join the revolution of bad ideas and be part of this unique experience!",
        marketInfoTitle: "Market Information",
        dashboardTitle: "Dashboard",
        walletNotConnected: "Wallet: Not connected",
        ideaOfDayTitle: "Idea of the Day",
        roadmapTitle: "Roadmap",
        roadmapPhase1: "Phase 1: Official launch of the website and the MALA token.",
        roadmapPhase2: "Phase 2: Implementation of on-chain voting and integration with pum.fun.",
        roadmapPhase3: "Phase 3: Integration of advanced features such as comments and rewards.",
        roadmapPhase4: "Phase 4: Community expansion and establishment of strategic partnerships.",
        roadmapPhase5: "Phase 5: Implementation of new features (staking, DAO, etc.) and overall improvements.",
        tokenomicsTitle: "Tokenomics",
        supplyTotal: "Supply Total: 1,000,000,000 MALA",
        tokenomicsItem1: "The majority of the supply will be distributed directly to the community to incentivize active participation and reward contributions.",
        tokenomicsItem2: "All tokens will be launched exclusively on pum.fun, without any private sales.",
        tokenomicsItem3: "Tokens will be allocated to drive marketing campaigns and ecosystem growth.",
        tokenomicsItem4: "Tokens will also be reserved to ensure liquidity and market stability.",
        tokenomicsItem5: "A limited amount will be allocated to the team and advisors to drive ongoing development.",
        searchPlaceholder: "Search ideas...",
        proposedIdeasTitle: "Proposed Ideas",
        proposeIdeaTitle: "Propose a Bad Idea",
        ideaTitlePlaceholder: "Idea Title",
        ideaDescriptionPlaceholder: "Idea Description",
        submitIdea: "Submit Idea",
        teamTitle: "Our Team",
        footerRights: "© 2025 MalaIdeaCoin. All rights reserved.",
        subscribeNewsletter: "Subscribe to our newsletter:",
        subscribe: "Subscribe",
        walletConnect: "Connect Wallet",
        toggleTheme: "Toggle Theme",
        ideaLabel: "Idea:",
        votesLabel: "Votes:",
        voteButton: "Vote",
        shareButton: "Share",
        commentButton: "Comments",
        addCommentPlaceholder: "Add a comment",
        commentSend: "Send",
        noComments: "No comments yet.",
        commentDelete: "Delete",
        priceLabel: "SOL Price:",
        walletBalanceError: "Error fetching Solana balance",
        walletConnectError: "Error connecting wallet",
        walletConnected: "Wallet connected:",
        phantomInstall: "Please install Phantom Wallet.",
        ideaCopied: "Idea copied to clipboard",
        copyError: "Error copying",
        fillAllFields: "Please complete all fields",
        ideaSubmitted: "Idea submitted successfully",
        commentEmpty: "Please enter a comment",
        commentAdded: "Comment added",
        commentDeleted: "Comment deleted"
      }
    };

    /**************************************************
     * FUNCIONES PARA LOCALSTORAGE (USO SEGURO)
     **************************************************/
    function safeSetItem(key, value) {
      try { localStorage.setItem(key, value); }
      catch (e) { console.error("localStorage error:", e); }
    }
    function safeGetItem(key) {
      try { return localStorage.getItem(key); }
      catch (e) { console.error("localStorage error:", e); return null; }
    }

    /**************************************************
     * FUNCION PARA OCULTAR PRELOADER
     **************************************************/
    function hidePreloader() {
      const preloader = document.getElementById("preloader");
      preloader.style.transition = "opacity 0.5s ease";
      preloader.style.opacity = "0";
      setTimeout(() => { preloader.style.display = "none"; }, 500);
    }

    /**************************************************
     * FUNCION PARA CAMBIAR IDIOMA
     **************************************************/
    function setLanguage(lang) {
      currentLanguage = lang;
      safeSetItem("language", lang);
      document.title = translations[lang].title;
      document.getElementById("headerH1").textContent = translations[lang].headerH1;
      document.getElementById("headerP").textContent = translations[lang].headerP;
      document.getElementById("countdownTitle").textContent = translations[lang].countdownTitle;
      document.getElementById("countdownTimer").textContent = translations[lang].countdownLoading;
      document.getElementById("storyTitle").textContent = translations[lang].storyTitle;
      document.getElementById("storyContent").textContent = translations[lang].storyContent;
      document.getElementById("marketInfoTitle").textContent = translations[lang].marketInfoTitle;
      document.getElementById("dashboardTitle").textContent = translations[lang].dashboardTitle;
      document.getElementById("walletNotConnected").textContent = translations[lang].walletNotConnected;
      document.getElementById("ideaOfDayTitle").textContent = translations[lang].ideaOfDayTitle;
      document.getElementById("roadmapTitle").textContent = translations[lang].roadmapTitle;
      document.getElementById("roadmapPhase1").textContent = translations[lang].roadmapPhase1;
      document.getElementById("roadmapPhase2").textContent = translations[lang].roadmapPhase2;
      document.getElementById("roadmapPhase3").textContent = translations[lang].roadmapPhase3;
      document.getElementById("roadmapPhase4").textContent = translations[lang].roadmapPhase4;
      document.getElementById("roadmapPhase5").textContent = translations[lang].roadmapPhase5;
      document.getElementById("tokenomicsTitle").textContent = translations[lang].tokenomicsTitle;
      document.getElementById("supplyTotal").textContent = translations[lang].supplyTotal;
      document.getElementById("tokenomicsItem1").textContent = translations[lang].tokenomicsItem1;
      document.getElementById("tokenomicsItem2").textContent = translations[lang].tokenomicsItem2;
      document.getElementById("tokenomicsItem3").textContent = translations[lang].tokenomicsItem3;
      document.getElementById("tokenomicsItem4").textContent = translations[lang].tokenomicsItem4;
      document.getElementById("tokenomicsItem5").textContent = translations[lang].tokenomicsItem5;
      document.getElementById("searchInput").placeholder = translations[lang].searchPlaceholder;
      document.getElementById("proposedIdeasTitle").textContent = translations[lang].proposedIdeasTitle;
      document.getElementById("proposeIdeaTitle").textContent = translations[lang].proposeIdeaTitle;
      document.getElementById("ideaTitle").placeholder = translations[lang].ideaTitlePlaceholder;
      document.getElementById("ideaDescription").placeholder = translations[lang].ideaDescriptionPlaceholder;
      document.getElementById("submitIdea").value = translations[lang].submitIdea;
      document.getElementById("teamTitle").textContent = translations[lang].teamTitle;
      document.getElementById("footerRights").textContent = translations[lang].footerRights;
      document.getElementById("subscribeNewsletter").textContent = translations[lang].subscribeNewsletter;
      document.getElementById("newsletterSubmit").textContent = translations[lang].subscribe;
      document.getElementById("connectWallet").textContent = translations[lang].walletConnect;
      document.getElementById("themeToggle").textContent = translations[lang].toggleTheme;
      // Actualizar elementos dinámicos
      renderIdeas();
      renderIdeaDelDia();
    }

    document.getElementById("langSelect").addEventListener("change", function() {
      setLanguage(this.value);
    });
    const savedLanguage = safeGetItem("language") || "es";
    setLanguage(savedLanguage);
    document.getElementById("langSelect").value = savedLanguage;

    /**************************************************
     * FUNCIONES DE INICIALIZACIÓN AL CARGAR LA PÁGINA
     **************************************************/
    window.addEventListener("load", () => {
      console.log("Página completamente cargada");
      hidePreloader();
      loadIdeas();
      loadComments();
      renderIdeas();
      renderIdeaDelDia();
      fetchPriceInfo();
      initCountdown();
    });

    /**************************************************
     * EFECTO PARALLAX EN HEADER (opcional)
     **************************************************/
    document.addEventListener("mousemove", (e) => {
      const header = document.querySelector("header");
      const xPos = (e.clientX / window.innerWidth - 0.5) * 20;
      const yPos = (e.clientY / window.innerHeight - 0.5) * 20;
      header.style.transform = `translate(${xPos}px, ${yPos}px)`;
    });

    /**************************************************
     * FUNCIÓN PARA MOSTRAR TOAST
     **************************************************/
    function showToast(message) {
      const toast = document.getElementById("toast");
      toast.textContent = message;
      toast.style.opacity = 1;
      setTimeout(() => { toast.style.opacity = 0; }, 3000);
    }

    /**************************************************
     * MODO CLARO/OSCURO
     **************************************************/
    function loadTheme() {
      const savedTheme = safeGetItem("theme");
      if (savedTheme === "light") {
        document.body.classList.add("light-mode");
      } else {
        document.body.classList.remove("light-mode");
      }
    }
    function toggleTheme() {
      document.body.classList.toggle("light-mode");
      safeSetItem("theme", document.body.classList.contains("light-mode") ? "light" : "dark");
    }
    document.getElementById("themeToggle").addEventListener("click", toggleTheme);
    loadTheme();

    /**************************************************
     * BOTÓN VOLVER AL INICIO
     **************************************************/
    const backToTopBtn = document.getElementById("backToTop");
    window.addEventListener("scroll", () => {
      backToTopBtn.style.opacity = window.scrollY > 300 ? 1 : 0;
    });
    backToTopBtn.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    /**************************************************
     * OBTENER PRECIO DE SOL (COINGECKO)
     **************************************************/
    function fetchPriceInfo() {
      fetch("https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd")
        .then(response => response.json())
        .then(data => {
          const price = data.solana ? data.solana.usd : "N/A";
          document.getElementById("priceInfo").innerHTML =
            `<strong>${translations[currentLanguage].priceLabel}</strong> $${price}`;
        })
        .catch(err => {
          document.getElementById("priceInfo").innerHTML =
            `<strong>${translations[currentLanguage].priceLabel}</strong> ${translations[currentLanguage].walletBalanceError}`;
          console.error(err);
        });
    }

    /**************************************************
     * CONECTAR WALLET (PHANTOM)
     **************************************************/
    const SOLANA_API_URL = "https://public-api.solscan.io/account/";
    async function connectWallet() {
      if (window.solana && window.solana.isPhantom) {
        try {
          const resp = await window.solana.connect();
          const publicKey = resp.publicKey.toString();
          document.getElementById("walletNotConnected").textContent =
            translations[currentLanguage].walletConnected + " " + publicKey;
          fetch(SOLANA_API_URL + publicKey)
            .then(response => response.json())
            .then(data => {
              const lamports = data.lamports || 0;
              const sol = lamports / 1000000000;
              document.getElementById("walletBalance").textContent =
                "Balance: " + sol.toFixed(2) + " SOL";
            })
            .catch(err => {
              console.error(err);
              showToast(translations[currentLanguage].walletBalanceError);
            });
          showToast(translations[currentLanguage].walletConnected + " " + publicKey);
        } catch (err) {
          console.error(err);
          showToast(translations[currentLanguage].walletConnectError);
        }
      } else {
        showToast(translations[currentLanguage].phantomInstall);
      }
    }
    document.getElementById("connectWallet").addEventListener("click", connectWallet);

    /**************************************************
     * MANEJO DE IDEAS Y COMENTARIOS (LOCALSTORAGE)
     **************************************************/
    function loadIdeas() {
      const ideasLS = safeGetItem("ideas");
      if (ideasLS) {
        sampleIdeas = JSON.parse(ideasLS);
      } else {
        safeSetItem("ideas", JSON.stringify(sampleIdeas));
      }
    }
    function saveIdeas() {
      safeSetItem("ideas", JSON.stringify(sampleIdeas));
    }
    function loadComments() {
      const stored = safeGetItem("comments");
      if (stored) { comments = JSON.parse(stored); }
    }
    function saveComments() {
      safeSetItem("comments", JSON.stringify(comments));
    }

    function renderComments(ideaId, commentsContainer) {
      commentsContainer.innerHTML = "";
      const ideaComments = comments[ideaId] || [];
      if (ideaComments.length === 0) {
        commentsContainer.innerHTML = `<p>${translations[currentLanguage].noComments}</p>`;
      } else {
        const ul = document.createElement("ul");
        ideaComments.forEach((comment, index) => {
          const li = document.createElement("li");
          li.innerHTML = `
            <span>${comment}</span>
            <button class="delete-comment" data-index="${index}">${translations[currentLanguage].commentDelete}</button>
          `;
          ul.appendChild(li);
        });
        commentsContainer.appendChild(ul);
        commentsContainer.querySelectorAll(".delete-comment").forEach(btn => {
          btn.addEventListener("click", function() {
            const idx = this.getAttribute("data-index");
            comments[ideaId].splice(idx, 1);
            saveComments();
            renderComments(ideaId, commentsContainer);
            showToast(translations[currentLanguage].commentDeleted);
          });
        });
      }
    }

    function renderIdeas() {
      const container = document.getElementById("ideasContainer");
      container.innerHTML = "";
      const query = document.getElementById("searchInput").value.toLowerCase();
      let filteredIdeas = sampleIdeas.filter(idea => idea.title.toLowerCase().includes(query));
      const sortOrder = document.getElementById("sortSelect").value;
      filteredIdeas.sort((a, b) => sortOrder === "asc" ? a.votes - b.votes : b.votes - a.votes);
      filteredIdeas.forEach(idea => {
        const card = document.createElement("div");
        card.classList.add("idea-card");
        card.setAttribute("data-id", idea.id);
        card.innerHTML = `
          <p><strong>${translations[currentLanguage].ideaLabel}</strong> ${idea.title}</p>
          <p><strong>${translations[currentLanguage].votesLabel}</strong> <span class="vote-count">${idea.votes}</span></p>
          <button class="vote-button">${translations[currentLanguage].voteButton}</button>
          <button class="share-button">${translations[currentLanguage].shareButton}</button>
          <button class="comment-button">${translations[currentLanguage].commentButton}</button>
          <div class="comments-section">
            <div class="existing-comments"></div>
            <div class="comment-form">
              <input type="text" placeholder="${translations[currentLanguage].addCommentPlaceholder}" />
              <button class="send-comment">${translations[currentLanguage].commentSend}</button>
            </div>
          </div>
        `;

        card.querySelector(".vote-button").addEventListener("click", () => {
          idea.votes++;
          card.querySelector(".vote-count").textContent = idea.votes;
          card.querySelector(".vote-count").style.color = "#8ef";
          setTimeout(() => { card.querySelector(".vote-count").style.color = "var(--text-color)"; }, 300);
          saveIdeas();
          renderIdeaDelDia();
        });

        card.querySelector(".share-button").addEventListener("click", () => {
          navigator.clipboard.writeText(idea.title)
            .then(() => showToast(translations[currentLanguage].ideaCopied))
            .catch(() => showToast(translations[currentLanguage].copyError));
        });

        const commentBtn = card.querySelector(".comment-button");
        const commentsSection = card.querySelector(".comments-section");
        commentBtn.addEventListener("click", () => {
          commentsSection.style.display = (commentsSection.style.display === "block") ? "none" : "block";
          if (commentsSection.style.display === "block") {
            renderComments(idea.id, commentsSection.querySelector(".existing-comments"));
          }
        });

        const commentForm = card.querySelector(".comment-form");
        const commentInput = commentForm.querySelector("input");
        const commentSendBtn = commentForm.querySelector(".send-comment");
        commentSendBtn.addEventListener("click", () => {
          const text = commentInput.value.trim();
          if (!text) {
            showToast(translations[currentLanguage].commentEmpty);
            return;
          }
          if (!comments[idea.id]) { comments[idea.id] = []; }
          comments[idea.id].push(text);
          saveComments();
          renderComments(idea.id, commentsSection.querySelector(".existing-comments"));
          commentInput.value = "";
          showToast(translations[currentLanguage].commentAdded);
        });

        container.appendChild(card);
      });
    }

    function renderIdeaDelDia() {
      const randomIdea = sampleIdeas[Math.floor(Math.random() * sampleIdeas.length)];
      document.getElementById("ideaDiaTexto").innerHTML = `<strong>${translations[currentLanguage].ideaLabel}</strong> ${randomIdea.title}`;
      document.getElementById("ideaDiaVotos").innerHTML = `<strong>${translations[currentLanguage].votesLabel}</strong> ${randomIdea.votes}`;
    }

    document.getElementById("ideaForm").addEventListener("submit", (event) => {
      event.preventDefault();
      const title = document.getElementById("ideaTitle").value.trim();
      const description = document.getElementById("ideaDescription").value.trim();
      if (!title || !description) {
        showToast(translations[currentLanguage].fillAllFields);
        return;
      }
      const fullIdea = title + " - " + description;
      const newIdea = { id: sampleIdeas.length + 1, title: fullIdea, votes: 0 };
      sampleIdeas.push(newIdea);
      saveIdeas();
      renderIdeas();
      showToast(translations[currentLanguage].ideaSubmitted);
      event.target.reset();
    });

    document.getElementById("searchInput").addEventListener("keyup", renderIdeas);
    document.getElementById("sortSelect").addEventListener("change", renderIdeas);

    /**************************************************
     * CUENTA REGRESIVA (7 DÍAS) CON PERSISTENCIA
     **************************************************/
    function initCountdown() {
      const countdownElement = document.getElementById("countdownTimer");
      let launchTime = safeGetItem("launchTime");
      if (!launchTime) {
        const totalDuration = 7 * 24 * 60 * 60 * 1000;
        launchTime = new Date().getTime() + totalDuration;
        safeSetItem("launchTime", launchTime);
      } else {
        launchTime = parseInt(launchTime);
      }
      function updateCountdown() {
        const now = new Date().getTime();
        const remaining = launchTime - now;
        if (remaining <= 0) {
          countdownElement.textContent = "¡Lanzado!";
          clearInterval(timerInterval);
          return;
        }
        const days = Math.floor(remaining / (1000 * 60 * 60 * 24));
        const hours = Math.floor((remaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((remaining % (1000 * 60)) / 1000);
        countdownElement.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
      }
      const timerInterval = setInterval(updateCountdown, 1000);
      updateCountdown();
    }

    /**************************************************
     * CONECTAR WALLET (PHANTOM)
     **************************************************/
    const SOLANA_API_URL = "https://public-api.solscan.io/account/";
    async function connectWallet() {
      if (window.solana && window.solana.isPhantom) {
        try {
          const resp = await window.solana.connect();
          const publicKey = resp.publicKey.toString();
          document.getElementById("walletNotConnected").textContent =
            translations[currentLanguage].walletConnected + " " + publicKey;
          fetch(SOLANA_API_URL + publicKey)
            .then(response => response.json())
            .then(data => {
              const lamports = data.lamports || 0;
              const sol = lamports / 1000000000;
              document.getElementById("walletBalance").textContent = "Balance: " + sol.toFixed(2) + " SOL";
            })
            .catch(err => {
              console.error(err);
              showToast(translations[currentLanguage].walletBalanceError);
            });
          showToast(translations[currentLanguage].walletConnected + " " + publicKey);
        } catch (err) {
          console.error(err);
          showToast(translations[currentLanguage].walletConnectError);
        }
      } else {
        showToast(translations[currentLanguage].phantomInstall);
      }
    }
    document.getElementById("connectWallet").addEventListener("click", connectWallet);

    /**************************************************
     * INICIALIZACIÓN AL CARGAR LA PÁGINA
     **************************************************/
    window.addEventListener("load", () => {
      console.log("Página completamente cargada");
      hidePreloader();
      loadIdeas();
      loadComments();
      renderIdeas();
      renderIdeaDelDia();
      fetchPriceInfo();
      initCountdown();
    });

    /**************************************************
     * EFECTO PARALLAX EN HEADER
     **************************************************/
    document.addEventListener("mousemove", (e) => {
      const header = document.querySelector("header");
      const xPos = (e.clientX / window.innerWidth - 0.5) * 20;
      const yPos = (e.clientY / window.innerHeight - 0.5) * 20;
      header.style.transform = `translate(${xPos}px, ${yPos}px)`;
    });

    /**************************************************
     * TOAST NOTIFICACIONES
     **************************************************/
    function showToast(message) {
      const toast = document.getElementById("toast");
      toast.textContent = message;
      toast.style.opacity = 1;
      setTimeout(() => { toast.style.opacity = 0; }, 3000);
    }

  </script>
</body>
</html>
